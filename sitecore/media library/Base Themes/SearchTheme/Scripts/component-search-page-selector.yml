---
ID: "435755fe-cc7c-45ab-8a7f-c54f089ea131"
Parent: "dfcbfa5a-2e37-418a-adb7-f411ecae89a9"
Template: "962b53c4-f93b-4df9-9821-415c867b8903"
Path: "/sitecore/media library/Base Themes/SearchTheme/Scripts/component-search-page-selector"
DB: master
SharedFields:
- ID: "06d5295c-ed2f-4a54-9bf2-26228d113318"
  Hint: __Icon
  Value: "-/media/435755FECC7C45AB8A7FC54F089EA131.ashx?h=16&thn=1&w=16"
- ID: "40e50ed9-ba07-4702-992e-a912738d32dc"
  Hint: Blob
  Value: LyoqDQogKiBGYWNldCBwYWdlIHNlbGVjdG9yIGNvbXBvbmVudCBmdW5jdGlvbmFsaXR5DQogKiBAbW9kdWxlIHNlYXJjaFBhZ2VTZWxlY3Rvcg0KICogQHBhcmFtICB7alF1ZXJ5fSAkIEluc3RhbmNlIG9mIGpRdWVyeQ0KICogQHBhcmFtICB7RG9jdW1lbnR9IGRvY3VtZW50IGRvbSBkb2N1bWVudCBvYmplY3QNCiAqIEByZXR1cm4ge09iamVjdH0gbGlzdCBvZiBtZXRob2RzIGZvciB3b3JraW5nIHdpdGggY29tcG9uZW50IHBhZ2Ugc2VsZWN0b3INCiovDQpYQS5jb21wb25lbnQuc2VhcmNoLnBhZ2VTZWxlY3RvciA9IChmdW5jdGlvbiAoJCwgZG9jdW1lbnQpIHsNCiAgICAvKioNCiAgICAqIFRoaXMgb2JqZWN0IHN0b3JlcyBhbGwgcHVibGljIGFwaSBtZXRob2RzDQogICAgKiBAdHlwZSB7T2JqZWN0LjxNZXRob2RzPn0NCiAgICAqIEBtZW1iZXJPZiBtb2R1bGU6c2VhcmNoUGFnZVNlbGVjdG9yDQogICAgKi8NCiAgICB2YXIgYXBpID0ge30sDQogICAgICAgIHF1ZXJ5TW9kZWw7DQogICAgZmFjZXROYW1lID0gImUiOw0KICAgIC8qKg0KICAgICogQG5hbWUgbW9kdWxlOnNlYXJjaFBhZ2VTZWxlY3Rvci5TZWFyY2hQYWdlU2VsZWN0b3JNb2RlbA0KICAgICogQGNvbnN0cnVjdG9yDQogICAgKiBAYXVnbWVudHMgQmFja2JvbmUuTW9kZWwNCiAgICAqLw0KICAgIHZhciBTZWFyY2hQYWdlU2VsZWN0b3JNb2RlbCA9IEJhY2tib25lLk1vZGVsLmV4dGVuZCgNCiAgICAgICAgLyoqIEBsZW5kcyBtb2R1bGU6c2VhcmNoUGFnZVNlbGVjdG9yLlNlYXJjaFBhZ2VTZWxlY3Rvck1vZGVsLnByb3RvdHlwZSAqKi8NCiAgICAgICAgew0KICAgICAgICAgICAgLyoqDQogICAgICAgICAgICAqIERlZmF1bHQgbW9kZWwgb3B0aW9ucw0KICAgICAgICAgICAgKiBAZGVmYXVsdA0KICAgICAgICAgICAgKi8NCiAgICAgICAgICAgIGRlZmF1bHRzOiB7DQogICAgICAgICAgICAgICAgZGF0YVByb3BlcnRpZXM6IHt9LA0KICAgICAgICAgICAgICAgIHJlc3VsdHNDb3VudDogMCwNCiAgICAgICAgICAgICAgICBvZmZzZXQ6IDAsDQogICAgICAgICAgICAgICAgc2VsZWN0ZWRWYWx1ZTogMSwNCiAgICAgICAgICAgICAgICBwYWdlU2l6ZTogMCwNCiAgICAgICAgICAgICAgICByZXBlYXRSZXF1ZXN0OiBmYWxzZSwNCiAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogIjx1bCBjbGFzcz0ncGFnZS1zZWxlY3Rvci1saXN0Jz4gIiArDQogICAgICAgICAgICAgICAgICAgICI8bGkgY2xhc3M9J3BhZ2Utc2VsZWN0b3ItaXRlbS1maXJzdCc+PGEgaHJlZj0nIyc+PCU9IGRhdGEuZmlyc3QgJT48L2E+PC9saT4iICsNCiAgICAgICAgICAgICAgICAgICAgIjxsaSBjbGFzcz0ncGFnZS1zZWxlY3Rvci1pdGVtLXByZXZpb3VzJz48YSBocmVmPScjJz48JT0gZGF0YS5wcmV2aW91cyAlPjwvYT48L2xpPiIgKw0KICAgICAgICAgICAgICAgICAgICAiPCUgdmFyIGJlZm9yZVBhZ2UgPSAwOyAlPiIgKw0KICAgICAgICAgICAgICAgICAgICAiPCUgXy5lYWNoKGRhdGEucGFnZXMsIGZ1bmN0aW9uKHBhZ2UpeyAlPiIgKw0KICAgICAgICAgICAgICAgICAgICAiPCUgaWYoKGJlZm9yZVBhZ2UrMSkgIT0gcGFnZS5udW1iZXIpeyAlPiIgKw0KICAgICAgICAgICAgICAgICAgICAiPGxpPjxzcGFuIGNsYXNzPSdwYWdlLXNlbGVjdG9yLW1vcmUnPi4uLjwvc3Bhbj48L2xpPiIgKw0KICAgICAgICAgICAgICAgICAgICAiPCUgfSAlPiIgKw0KICAgICAgICAgICAgICAgICAgICAiPCUgYmVmb3JlUGFnZSA9IHBhZ2UubnVtYmVyOyAlPiIgKw0KICAgICAgICAgICAgICAgICAgICAiPCUgaWYoZGF0YS5zZWxlY3RlZFZhbHVlID09PSBwYWdlLm51bWJlcil7ICU+IiArDQogICAgICAgICAgICAgICAgICAgICI8JSBhY3RpdmUgPSAnYWN0aXZlJzsgJT4iICsNCiAgICAgICAgICAgICAgICAgICAgIjwlIH1lbHNlIHsgYWN0aXZlID0gJycgfSAlPiIgKw0KICAgICAgICAgICAgICAgICAgICAiPGxpPjxhIGNsYXNzPSdwYWdlLXNlbGVjdG9yLWl0ZW0tbGluayA8JT0gYWN0aXZlICU+JyBkYXRhLW9mZnNldD0nPCU9IHBhZ2Uub2Zmc2V0ICU+JyBkYXRhLWl0ZW1OdW1iZXI9JzwlPSBwYWdlLm51bWJlciAlPicgaHJlZj0nIyc+PCU9IHBhZ2UubnVtYmVyICU+PC9hPjwvbGk+IiArDQogICAgICAgICAgICAgICAgICAgICI8JSB9KTsgJT4iICsNCiAgICAgICAgICAgICAgICAgICAgIjxsaSBjbGFzcz0ncGFnZS1zZWxlY3Rvci1pdGVtLW5leHQnPjxhIGhyZWY9JyMnPjwlPSBkYXRhLm5leHQgJT48L2E+PC9saT4iICsNCiAgICAgICAgICAgICAgICAgICAgIjxsaSBjbGFzcz0ncGFnZS1zZWxlY3Rvci1pdGVtLWxhc3QnPjxhIGhyZWY9JyMnPjwlPSBkYXRhLmxhc3QgJT48L2E+PC9saT4iICsNCiAgICAgICAgICAgICAgICAgICAgIjwvdWw+IiwNCiAgICAgICAgICAgICAgICBzaWc6IFtdLA0KICAgICAgICAgICAgICAgIHRpbWVTdGFtcDogbmV3IERhdGUoKS5nZXRUaW1lKCkNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgLyoqDQogICAgICogQG5hbWUgbW9kdWxlOnNlYXJjaFBhZ2VTZWxlY3Rvci5TZWFyY2hQYWdlU2VsZWN0b3JWaWV3DQogICAgICogQGNvbnN0cnVjdG9yDQogICAgICogQGF1Z21lbnRzIEJhY2tib25lLlZpZXcNCiAgICAgKi8NCiAgICB2YXIgU2VhcmNoUGFnZVNlbGVjdG9yVmlldyA9IFhBLmNvbXBvbmVudC5zZWFyY2guYmFzZVZpZXcuZXh0ZW5kKA0KICAgICAgICAvKiogQGxlbmRzIG1vZHVsZTpzZWFyY2hQYWdlU2VsZWN0b3IuU2VhcmNoUGFnZVNlbGVjdG9yVmlldyAqKi8NCiAgICAgICAgew0KICAgICAgICAgICAgLyoqDQogICAgICAgICAgICogSW5pdGlhbGx5IHNldHMgZGF0YSB0byBtb2RlbCBhbmQgd2F0Y2hlcyBldmVudHMgb24gd2hpY2gNCiAgICAgICAgICAgKiB2aWV3IHNob3VsZCBiZSB1cGRhdGVkDQogICAgICAgICAgICogQGxpc3RlbnMgbW9kdWxlOnNlYXJjaFBhZ2VTZWxlY3Rvci5TZWFyY2hQYWdlU2VsZWN0b3JWaWV3fmV2ZW50OmNoYW5nZQ0KICAgICAgICAgICAqIEBsaXN0ZW5zIG1vZHVsZTpYQS5jb21wb25lbnQuc2VhcmNoLnZlbnR+ZXZlbnQ6cmVzdWx0cy1sb2FkZWQNCiAgICAgICAgICAgKiBAbWVtYmVyb2YgbW9kdWxlOnNlYXJjaFBhZ2VTZWxlY3Rvci5TZWFyY2hQYWdlU2VsZWN0b3JWaWV3DQogICAgICAgICAgICogQGFsaWFzIG1vZHVsZTpzZWFyY2hQYWdlU2VsZWN0b3IuU2VhcmNoUGFnZVNlbGVjdG9yVmlldyNpbml0aWFsaXplDQogICAgICAgICAgICovDQogICAgICAgICAgICBpbml0aWFsaXplOiBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgdmFyIGRhdGFQcm9wID0gdGhpcy4kZWwuZGF0YSgpOw0KDQogICAgICAgICAgICAgICAgaWYgKGRhdGFQcm9wLnByb3BlcnRpZXMuc2VhcmNoUmVzdWx0c1NpZ25hdHVyZSA9PT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICBkYXRhUHJvcC5wcm9wZXJ0aWVzLnNlYXJjaFJlc3VsdHNTaWduYXR1cmUgPSAiIjsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICB0aGlzLm1vZGVsLnNldCgiZGF0YVByb3BlcnRpZXMiLCBkYXRhUHJvcCk7DQogICAgICAgICAgICAgICAgdGhpcy5tb2RlbC5zZXQoInNpZyIsIHRoaXMudHJhbnNsYXRlU2lnbmF0dXJlcyhkYXRhUHJvcC5wcm9wZXJ0aWVzLnNlYXJjaFJlc3VsdHNTaWduYXR1cmUsIGZhY2V0TmFtZSkpOw0KICAgICAgICAgICAgICAgIHRoaXMubW9kZWwub24oImNoYW5nZSIsIHRoaXMucmVuZGVyLCB0aGlzKTsNCg0KICAgICAgICAgICAgICAgIFhBLmNvbXBvbmVudC5zZWFyY2gudmVudC5vbigicmVzdWx0cy1sb2FkZWQiLCB0aGlzLmhhbmRsZUxvYWRlZERhdGEuYmluZCh0aGlzKSk7DQoNCiAgICAgICAgICAgICAgICAvL2NoZWNrIHdoZXRoZXIgcGFnZSBpcyBvcGVuZWQgZnJvbSBkaXNjIC0gaWYgeWVzIHRoZW4gd2UgYXJlIGluIENyZWF0aXZlIEV4Y2hhbmdlIG1vZGUgYW5kIGxldHMgbW9jayBzb21lIGNvbnRlbnQNCiAgICAgICAgICAgICAgICBpZiAod2luZG93LmxvY2F0aW9uLmhyZWYuc3RhcnRzV2l0aCgiZmlsZTovLyIpKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubW9kZWwuc2V0KHsNCiAgICAgICAgICAgICAgICAgICAgICAgICJyZXN1bHRzQ291bnQiOiAxMCwNCiAgICAgICAgICAgICAgICAgICAgICAgICJwYWdlU2l6ZSI6IDIsDQogICAgICAgICAgICAgICAgICAgICAgICAic2VsZWN0ZWRWYWx1ZSI6IDINCiAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIC8qKg0KICAgICAgICAgICAgICogbGlzdCBvZiBldmVudHMgZm9yIEJhY2tib25lIFZpZXcNCiAgICAgICAgICAgICAqIEBtZW1iZXJvZiBtb2R1bGU6c2VhcmNoUGFnZVNlbGVjdG9yLlNlYXJjaFBhZ2VTZWxlY3RvclZpZXcNCiAgICAgICAgICAgICAqIEBhbGlhcyBtb2R1bGU6c2VhcmNoUGFnZVNlbGVjdG9yLlNlYXJjaFBhZ2VTZWxlY3RvclZpZXcjZXZlbnRzDQogICAgICAgICAgICAgKi8NCiAgICAgICAgICAgIGV2ZW50czogew0KICAgICAgICAgICAgICAgICdjbGljayAucGFnZS1zZWxlY3Rvci1pdGVtLWxpbmsnOiAidXBkYXRlU2VsZWN0ZWRWYWx1ZSIsDQogICAgICAgICAgICAgICAgJ2NsaWNrIC5wYWdlLXNlbGVjdG9yLWl0ZW0tZmlyc3QgYSc6ICJzaG93Rmlyc3RQYWdlIiwNCiAgICAgICAgICAgICAgICAnY2xpY2sgLnBhZ2Utc2VsZWN0b3ItaXRlbS1sYXN0IGEnOiAic2hvd0xhc3RQYWdlIiwNCiAgICAgICAgICAgICAgICAnY2xpY2sgLnBhZ2Utc2VsZWN0b3ItaXRlbS1wcmV2aW91cyBhJzogInNob3dQcmV2UGFnZSIsDQogICAgICAgICAgICAgICAgJ2NsaWNrIC5wYWdlLXNlbGVjdG9yLWl0ZW0tbmV4dCBhJzogInNob3dOZXh0UGFnZSINCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAvKioNCiAgICAgICAgICAgICogVXBkYXRlcyBtb2RlbCB2YWx1ZXMgd2l0aCBzZWxlY3RlZFZhbHVlDQogICAgICAgICAgICAqIGFuZCBkYXRhIG9iamVjdCBmcm9tIHNlcnZlciByZXNwb25zZQ0KICAgICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YSBEYXRhIHRoYXQgY29udGFpbnMgY29tcG9uZW50IHByb3BlcnRpZXMNCiAgICAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IHNlbGVjdGVkVmFsdWUgbnVtYmVyIG9mIHNlbGVjdGVkIHBhZ2UgDQogICAgICAgICAgICAqIEBtZW1iZXJPZiBtb2R1bGU6c2VhcmNoUGFnZVNlbGVjdG9yLlNlYXJjaFBhZ2VTZWxlY3RvclZpZXcNCiAgICAgICAgICAgICogQGFsaWFzIG1vZHVsZTpzZWFyY2hQYWdlU2VsZWN0b3IuU2VhcmNoUGFnZVNlbGVjdG9yVmlldyN1cGRhdGVNb2RlbEFmdGVyU2VhcmNoDQogICAgICAgICAgICAqLw0KICAgICAgICAgICAgdXBkYXRlTW9kZWxBZnRlclNlYXJjaDogZnVuY3Rpb24gKGRhdGEsIHNlbGVjdGVkVmFsdWUpIHsNCiAgICAgICAgICAgICAgICB0aGlzLm1vZGVsLnNldCh7DQogICAgICAgICAgICAgICAgICAgICJwYWdlU2l6ZSI6IHBhcnNlSW50KGRhdGEucGFnZVNpemUpLA0KICAgICAgICAgICAgICAgICAgICAicmVzdWx0c0NvdW50IjogcGFyc2VJbnQoZGF0YS5kYXRhQ291bnQpLA0KICAgICAgICAgICAgICAgICAgICAib2Zmc2V0IjogcGFyc2VJbnQoZGF0YS5vZmZzZXQpLA0KICAgICAgICAgICAgICAgICAgICAic2VsZWN0ZWRWYWx1ZSI6IHBhcnNlSW50KHNlbGVjdGVkVmFsdWUpDQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgdGhpcy5tb2RlbC5zZXQoInRpbWVTdGFtcCIsIG5ldyBEYXRlKCkuZ2V0VGltZSgpKTsNCiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUVsZW1lbnRDc3NDbGFzcyhkYXRhKTsNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAvKioNCiAgICAgICAgICAgICogRnVuY3Rpb24gdGhhdCBiYXNlZCBvbiBzZWxlY3RlZCBjb21wb25lbnQgdmFsdWVzIHNldHMgY3NzIGNsYXNzDQogICAgICAgICAgICAqIHBhZ2Utc2VsZWN0b3ItZW1wdHkgb3IgcGFnZS1zZWxlY3Rvci1zaW5nbGUtcGFnZQ0KICAgICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YSBEYXRhIHRoYXQgY29udGFpbnMgY29tcG9uZW50IHByb3BlcnRpZXMNCiAgICAgICAgICAgICogQG1lbWJlck9mIG1vZHVsZTpzZWFyY2hQYWdlU2VsZWN0b3IuU2VhcmNoUGFnZVNlbGVjdG9yVmlldw0KICAgICAgICAgICAgKiBAYWxpYXMgbW9kdWxlOnNlYXJjaFBhZ2VTZWxlY3Rvci5TZWFyY2hQYWdlU2VsZWN0b3JWaWV3I3VwZGF0ZUVsZW1lbnRDc3NDbGFzcw0KICAgICAgICAgICAgKi8NCiAgICAgICAgICAgIHVwZGF0ZUVsZW1lbnRDc3NDbGFzczogZnVuY3Rpb24gKGRhdGEpIHsNCiAgICAgICAgICAgICAgICB0aGlzLmVsLmNsYXNzTGlzdC5yZW1vdmUoInBhZ2Utc2VsZWN0b3ItZW1wdHkiKQ0KICAgICAgICAgICAgICAgIHRoaXMuZWwuY2xhc3NMaXN0LnJlbW92ZSgicGFnZS1zZWxlY3Rvci1zaW5nbGUtcGFnZSIpDQogICAgICAgICAgICAgICAgaWYgKGRhdGEuZGF0YUNvdW50ID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZWwuY2xhc3NMaXN0LmFkZCgicGFnZS1zZWxlY3Rvci1lbXB0eSIpDQogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkYXRhLnBhZ2VTaXplID4gZGF0YS5kYXRhQ291bnQgfHwgZGF0YS5vZmZzZXQgPiBkYXRhLmRhdGFDb3VudCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmVsLmNsYXNzTGlzdC5hZGQoInBhZ2Utc2VsZWN0b3Itc2luZ2xlLXBhZ2UiKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAvKioNCiAgICAgICAgICAgICogVXBkYXRlcyBoYXNoIGFjY29yZGluZyB0byBjaGFuZ2VkIGNvbXBvbmVudCB2YWx1ZQ0KICAgICAgICAgICAgKiBAcGFyYW0ge0V2ZW50fSBldmVudCBFdmVudCBvYmplY3QgdGhhdCBjb250YWlucyB0YXJnZXQgd2l0aCBzZWxlY3RlZCBjb21wb25lbnQgdmFsdWUNCiAgICAgICAgICAgICogQG1lbWJlck9mIG1vZHVsZTpzZWFyY2hQYWdlU2VsZWN0b3IuU2VhcmNoUGFnZVNlbGVjdG9yVmlldw0KICAgICAgICAgICAgKiBAYWxpYXMgbW9kdWxlOnNlYXJjaFBhZ2VTZWxlY3Rvci5TZWFyY2hQYWdlU2VsZWN0b3JWaWV3I3VwZGF0ZVNlbGVjdGVkVmFsdWUNCiAgICAgICAgICAgICovDQogICAgICAgICAgICB1cGRhdGVTZWxlY3RlZFZhbHVlOiBmdW5jdGlvbiAoZXZlbnQpIHsNCiAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOw0KDQogICAgICAgICAgICAgICAgdmFyIHNpZyA9IHRoaXMubW9kZWwuZ2V0KCJzaWciKSwNCiAgICAgICAgICAgICAgICAgICAgZGF0YVByb3AgPSAkKGV2ZW50LnRhcmdldCkuZGF0YSgpOw0KDQogICAgICAgICAgICAgICAgcXVlcnlNb2RlbC51cGRhdGVIYXNoKHRoaXMudXBkYXRlU2lnbmF0dXJlc0hhc2goc2lnLCBkYXRhUHJvcC5vZmZzZXQsIHt9KSk7DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgLyoqDQogICAgICAgICAgICAqIFN3aXRjaGVzIHBhZ2Ugc2VsZWN0b3IgdG8gdGhlIGZpcnN0IHBhZ2UgYW5kIHVwZGF0ZXMgaGFzaCBwYXJhbWV0ZXJzDQogICAgICAgICAgICAqIEBwYXJhbSB7RXZlbnR9IGV2ZW50IEV2ZW50IG9iamVjdCB0aGF0IGNvbnRhaW5zIHRhcmdldCB3aXRoIHNlbGVjdGVkIGNvbXBvbmVudCB2YWx1ZQ0KICAgICAgICAgICAgKiBAbWVtYmVyT2YgbW9kdWxlOnNlYXJjaFBhZ2VTZWxlY3Rvci5TZWFyY2hQYWdlU2VsZWN0b3JWaWV3DQogICAgICAgICAgICAqIEBhbGlhcyBtb2R1bGU6c2VhcmNoUGFnZVNlbGVjdG9yLlNlYXJjaFBhZ2VTZWxlY3RvclZpZXcjc2hvd0ZpcnN0UGFnZQ0KICAgICAgICAgICAgKi8NCiAgICAgICAgICAgIHNob3dGaXJzdFBhZ2U6IGZ1bmN0aW9uIChldmVudCkgew0KICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7DQoNCiAgICAgICAgICAgICAgICB2YXIgc2lnID0gdGhpcy5tb2RlbC5nZXQoInNpZyIpLA0KICAgICAgICAgICAgICAgICAgICBkYXRhUHJvcCA9ICQoZXZlbnQudGFyZ2V0KS5kYXRhKCk7DQoNCiAgICAgICAgICAgICAgICBxdWVyeU1vZGVsLnVwZGF0ZUhhc2godGhpcy51cGRhdGVTaWduYXR1cmVzSGFzaChzaWcsIDAsIHt9KSk7DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgLyoqDQogICAgICAgICAgICAqIFN3aXRjaGVzIHBhZ2Ugc2VsZWN0b3IgdG8gdGhlIGxhc3QgcGFnZSBhbmQgdXBkYXRlcyBoYXNoIHBhcmFtZXRlcnMNCiAgICAgICAgICAgICogQHBhcmFtIHtFdmVudH0gZXZlbnQgRXZlbnQgb2JqZWN0IHRoYXQgY29udGFpbnMgdGFyZ2V0IHdpdGggc2VsZWN0ZWQgY29tcG9uZW50IHZhbHVlDQogICAgICAgICAgICAqIEBtZW1iZXJPZiBtb2R1bGU6c2VhcmNoUGFnZVNlbGVjdG9yLlNlYXJjaFBhZ2VTZWxlY3RvclZpZXcNCiAgICAgICAgICAgICogQGFsaWFzIG1vZHVsZTpzZWFyY2hQYWdlU2VsZWN0b3IuU2VhcmNoUGFnZVNlbGVjdG9yVmlldyNzaG93TGFzdFBhZ2UNCiAgICAgICAgICAgICovDQogICAgICAgICAgICBzaG93TGFzdFBhZ2U6IGZ1bmN0aW9uIChldmVudCkgew0KICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgICAgICAgICAgdmFyIGxhc3RQYWdlSXRlbXMgPSB0aGlzLm1vZGVsLmdldCgicmVzdWx0c0NvdW50IikgJSB0aGlzLm1vZGVsLmdldCgicGFnZVNpemUiKSwNCiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0ID0gdGhpcy5tb2RlbC5nZXQoInJlc3VsdHNDb3VudCIpIC0gKChsYXN0UGFnZUl0ZW1zID09PSAwKSA/IHRoaXMubW9kZWwuZ2V0KCJwYWdlU2l6ZSIpIDogbGFzdFBhZ2VJdGVtcyksDQogICAgICAgICAgICAgICAgICAgIHNpZyA9IHRoaXMubW9kZWwuZ2V0KCJzaWciKTsNCg0KICAgICAgICAgICAgICAgIHF1ZXJ5TW9kZWwudXBkYXRlSGFzaCh0aGlzLnVwZGF0ZVNpZ25hdHVyZXNIYXNoKHNpZywgb2Zmc2V0LCB7fSkpOw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIC8qKg0KICAgICAgICAgICAgKiBTd2l0Y2hlcyBwYWdlIHNlbGVjdG9yIHRvIHRoZSBuZXh0IHBhZ2UgYW5kIHVwZGF0ZXMgaGFzaCBwYXJhbWV0ZXJzDQogICAgICAgICAgICAqIEBwYXJhbSB7RXZlbnR9IGV2ZW50IEV2ZW50IG9iamVjdCB0aGF0IGNvbnRhaW5zIHRhcmdldCB3aXRoIHNlbGVjdGVkIGNvbXBvbmVudCB2YWx1ZQ0KICAgICAgICAgICAgKiBAbWVtYmVyT2YgbW9kdWxlOnNlYXJjaFBhZ2VTZWxlY3Rvci5TZWFyY2hQYWdlU2VsZWN0b3JWaWV3DQogICAgICAgICAgICAqIEBhbGlhcyBtb2R1bGU6c2VhcmNoUGFnZVNlbGVjdG9yLlNlYXJjaFBhZ2VTZWxlY3RvclZpZXcjc2hvd05leHRQYWdlDQogICAgICAgICAgICAqLw0KICAgICAgICAgICAgc2hvd05leHRQYWdlOiBmdW5jdGlvbiAoZXZlbnQpIHsNCiAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOw0KDQogICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9IHRoaXMubW9kZWwuZ2V0KCJvZmZzZXQiKSwNCiAgICAgICAgICAgICAgICAgICAgc2lnID0gdGhpcy5tb2RlbC5nZXQoInNpZyIpOw0KDQogICAgICAgICAgICAgICAgaWYgKChvZmZzZXQgKyB0aGlzLm1vZGVsLmdldCgicGFnZVNpemUiKSkgPCB0aGlzLm1vZGVsLmdldCgicmVzdWx0c0NvdW50IikpIHsNCiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0ICs9IHRoaXMubW9kZWwuZ2V0KCJwYWdlU2l6ZSIpOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIHF1ZXJ5TW9kZWwudXBkYXRlSGFzaCh0aGlzLnVwZGF0ZVNpZ25hdHVyZXNIYXNoKHNpZywgb2Zmc2V0LCB7fSkpOw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIC8qKg0KICAgICAgICAgICAgKiBTd2l0Y2hlcyBwYWdlIHNlbGVjdG9yIHRvIHRoZSBwcmVjaW91cyBwYWdlIGFuZCB1cGRhdGVzIGhhc2ggcGFyYW1ldGVycw0KICAgICAgICAgICAgKiBAcGFyYW0ge0V2ZW50fSBldmVudCBFdmVudCBvYmplY3QgdGhhdCBjb250YWlucyB0YXJnZXQgd2l0aCBzZWxlY3RlZCBjb21wb25lbnQgdmFsdWUNCiAgICAgICAgICAgICogQG1lbWJlck9mIG1vZHVsZTpzZWFyY2hQYWdlU2VsZWN0b3IuU2VhcmNoUGFnZVNlbGVjdG9yVmlldw0KICAgICAgICAgICAgKiBAYWxpYXMgbW9kdWxlOnNlYXJjaFBhZ2VTZWxlY3Rvci5TZWFyY2hQYWdlU2VsZWN0b3JWaWV3I3Nob3dQcmV2UGFnZQ0KICAgICAgICAgICAgKi8NCiAgICAgICAgICAgIHNob3dQcmV2UGFnZTogZnVuY3Rpb24gKGV2ZW50KSB7DQogICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsNCg0KICAgICAgICAgICAgICAgIHZhciBvZmZzZXQgPSB0aGlzLm1vZGVsLmdldCgib2Zmc2V0IiksDQogICAgICAgICAgICAgICAgICAgIGRhdGFQcm9wID0gJChldmVudC50YXJnZXQpLmRhdGEoKSwNCiAgICAgICAgICAgICAgICAgICAgc2lnID0gdGhpcy5tb2RlbC5nZXQoInNpZyIpOw0KDQogICAgICAgICAgICAgICAgaWYgKChvZmZzZXQgLSB0aGlzLm1vZGVsLmdldCgicGFnZVNpemUiKSkgPj0gMCkgew0KICAgICAgICAgICAgICAgICAgICBvZmZzZXQgLT0gdGhpcy5tb2RlbC5nZXQoInBhZ2VTaXplIik7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgcXVlcnlNb2RlbC51cGRhdGVIYXNoKHRoaXMudXBkYXRlU2lnbmF0dXJlc0hhc2goc2lnLCBvZmZzZXQsIHt9KSk7DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgLyoqDQogICAgICAgICAgICAqIFJlbmRlcnMgdmlldw0KICAgICAgICAgICAgKiBAbWVtYmVyT2YgbW9kdWxlOnNlYXJjaFBhZ2VTZWxlY3Rvci5TZWFyY2hQYWdlU2VsZWN0b3JWaWV3DQogICAgICAgICAgICAqIEBhbGlhcyBtb2R1bGU6c2VhcmNoUGFnZVNlbGVjdG9yLlNlYXJjaFBhZ2VTZWxlY3RvclZpZXcjcmVuZGVyDQogICAgICAgICAgICAqLw0KICAgICAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgdmFyIGluc3QgPSB0aGlzLA0KICAgICAgICAgICAgICAgICAgICBkYXRhUHJvcCA9IHRoaXMubW9kZWwuZ2V0KCJkYXRhUHJvcGVydGllcyIpLnByb3BlcnRpZXMsDQogICAgICAgICAgICAgICAgICAgIHJlc3VsdHNDb3VudCA9IHRoaXMubW9kZWwuZ2V0KCJyZXN1bHRzQ291bnQiKSwNCiAgICAgICAgICAgICAgICAgICAgcGFnZVNpemUgPSB0aGlzLm1vZGVsLmdldCgicGFnZVNpemUiKSwNCiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRWYWx1ZSA9IHRoaXMubW9kZWwuZ2V0KCJzZWxlY3RlZFZhbHVlIiksDQogICAgICAgICAgICAgICAgICAgIHBhZ2VzQ291bnQgPSBNYXRoLmNlaWwocmVzdWx0c0NvdW50IC8gcGFnZVNpemUpLA0KICAgICAgICAgICAgICAgICAgICBwYWdlcyA9IFtdLA0KICAgICAgICAgICAgICAgICAgICByYW5nZVN0YXJ0ID0gc2VsZWN0ZWRWYWx1ZSAtIGRhdGFQcm9wLnRyZXNob2xkIC8gMiwNCiAgICAgICAgICAgICAgICAgICAgcmFuZ2VFbmQgPSBzZWxlY3RlZFZhbHVlICsgZGF0YVByb3AudHJlc2hvbGQgLyAyLA0KICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZU9iajsNCg0KICAgICAgICAgICAgICAgIGlmIChyYW5nZVN0YXJ0IDwgMCkgew0KICAgICAgICAgICAgICAgICAgICByYW5nZUVuZCArPSBNYXRoLmFicyhyYW5nZVN0YXJ0KTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBpZiAocmFuZ2VFbmQgPiBwYWdlc0NvdW50KSB7DQogICAgICAgICAgICAgICAgICAgIHJhbmdlU3RhcnQgLT0gKHJhbmdlRW5kIC0gcGFnZXNDb3VudCk7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgaWYgKGRhdGFQcm9wLnRyZXNob2xkID49IHBhZ2VzQ291bnQpIHsNCiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwYWdlc0NvdW50OyBpKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2VzLnB1c2goeyBudW1iZXI6IGkgKyAxLCBvZmZzZXQ6IGkgKiBwYWdlU2l6ZSB9KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPD0gcGFnZXNDb3VudDsgaSsrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoKGkgPT09IDEpIHx8IChpID09PSBwYWdlc0NvdW50KSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2VzLnB1c2goeyBudW1iZXI6IGksIG9mZnNldDogKGkgLSAxKSAqIHBhZ2VTaXplIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoKGkgPj0gcmFuZ2VTdGFydCkgJiYgKGkgPD0gcmFuZ2VFbmQpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFnZXMucHVzaCh7IG51bWJlcjogaSwgb2Zmc2V0OiAoaSAtIDEpICogcGFnZVNpemUgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICB0ZW1wbGF0ZU9iaiA9IHsNCiAgICAgICAgICAgICAgICAgICAgcHJldmlvdXM6IGRhdGFQcm9wLnByZXZpb3VzLA0KICAgICAgICAgICAgICAgICAgICBmaXJzdDogZGF0YVByb3AuZmlyc3QsDQogICAgICAgICAgICAgICAgICAgIG5leHQ6IGRhdGFQcm9wLm5leHQsDQogICAgICAgICAgICAgICAgICAgIGxhc3Q6IGRhdGFQcm9wLmxhc3QsDQogICAgICAgICAgICAgICAgICAgIHBhZ2VzOiBwYWdlcywNCiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRWYWx1ZTogc2VsZWN0ZWRWYWx1ZQ0KICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgdmFyIHRlbXBsYXRlID0gXy50ZW1wbGF0ZShpbnN0Lm1vZGVsLmdldCgidGVtcGxhdGUiKSk7DQogICAgICAgICAgICAgICAgdmFyIHRlbXBsYXRlUmVzdWx0ID0gdGVtcGxhdGUoeyBkYXRhOiB0ZW1wbGF0ZU9iaiB9KTsNCiAgICAgICAgICAgICAgICB0aGlzLiRlbC5odG1sKHRlbXBsYXRlUmVzdWx0KTsNCg0KICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlQnV0dG9uU3RhdGUoc2VsZWN0ZWRWYWx1ZSwgcGFnZXNDb3VudCk7DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgLyoqDQogICAgICAgICAgICAqIFNldHMgdXAgcGFnZSBzZWxlY3RvcnMgYnV0dG9ucyBzdGF0ZSBkZXBlbmRpbmcgb24gc2VsZWN0ZWQgdmFsdWVzDQogICAgICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSBzZWxlY3RlZFBhZ2UgbnVtYmVyIG9mIHNlbGVjdGVkIHBhZ2UNCiAgICAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IHBhZ2VDb3VudCBudW1iZXIgb2YgcGFnZXMNCiAgICAgICAgICAgICogQG1lbWJlck9mIG1vZHVsZTpzZWFyY2hQYWdlU2VsZWN0b3IuU2VhcmNoUGFnZVNlbGVjdG9yVmlldw0KICAgICAgICAgICAgKiBAYWxpYXMgbW9kdWxlOnNlYXJjaFBhZ2VTZWxlY3Rvci5TZWFyY2hQYWdlU2VsZWN0b3JWaWV3I2hhbmRsZUJ1dHRvblN0YXRlDQogICAgICAgICAgICAqLw0KICAgICAgICAgICAgaGFuZGxlQnV0dG9uU3RhdGU6IGZ1bmN0aW9uIChzZWxlY3RlZFBhZ2UsIHBhZ2VDb3VudCkgew0KICAgICAgICAgICAgICAgIHRoaXMuJGVsLmZpbmQoIi5wYWdlLXNlbGVjdG9yLWl0ZW0tbGFzdCwgLnBhZ2Utc2VsZWN0b3ItaXRlbS1uZXh0IikucmVtb3ZlQ2xhc3MoImluYWN0aXZlIik7DQogICAgICAgICAgICAgICAgdGhpcy4kZWwuZmluZCgiLnBhZ2Utc2VsZWN0b3ItaXRlbS1maXJzdCwgLnBhZ2Utc2VsZWN0b3ItaXRlbS1wcmV2aW91cyIpLnJlbW92ZUNsYXNzKCJpbmFjdGl2ZSIpOw0KDQoNCiAgICAgICAgICAgICAgICBpZiAocGFnZUNvdW50ID09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kZWwuZmluZCgiLnBhZ2Utc2VsZWN0b3ItaXRlbS1maXJzdCwgLnBhZ2Utc2VsZWN0b3ItaXRlbS1wcmV2aW91cyIpLmFkZENsYXNzKCJpbmFjdGl2ZSIpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRlbC5maW5kKCIucGFnZS1zZWxlY3Rvci1pdGVtLWxhc3QsIC5wYWdlLXNlbGVjdG9yLWl0ZW0tbmV4dCIpLmFkZENsYXNzKCJpbmFjdGl2ZSIpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkUGFnZSA9PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRlbC5maW5kKCIucGFnZS1zZWxlY3Rvci1pdGVtLWZpcnN0LCAucGFnZS1zZWxlY3Rvci1pdGVtLXByZXZpb3VzIikuYWRkQ2xhc3MoImluYWN0aXZlIik7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkUGFnZSA9PSBwYWdlQ291bnQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJGVsLmZpbmQoIi5wYWdlLXNlbGVjdG9yLWl0ZW0tbGFzdCwgLnBhZ2Utc2VsZWN0b3ItaXRlbS1uZXh0IikuYWRkQ2xhc3MoImluYWN0aXZlIik7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgLyoqDQogICAgICAgICAgICAqIFVwZGF0ZXMgaGFzaCBhbmQgbW9kZWwgYmFzZWQgb24gZGF0YSBvYmplY3QNCiAgICAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IGRhdGEgRGF0YSB0aGF0IGNvbnRhaW5zIGNvbXBvbmVudCBwcm9wZXJ0aWVzDQogICAgICAgICAgICAqIEBtZW1iZXJPZiBtb2R1bGU6c2VhcmNoUGFnZVNlbGVjdG9yLlNlYXJjaFBhZ2VTZWxlY3RvclZpZXcNCiAgICAgICAgICAgICogQGFsaWFzIG1vZHVsZTpzZWFyY2hQYWdlU2VsZWN0b3IuU2VhcmNoUGFnZVNlbGVjdG9yVmlldyNoYW5kbGVMb2FkZWREYXRhDQogICAgICAgICAgICAqLw0KICAgICAgICAgICAgaGFuZGxlTG9hZGVkRGF0YTogZnVuY3Rpb24gKGRhdGEpIHsNCiAgICAgICAgICAgICAgICB2YXIgdGhhdCA9IHRoaXMsDQogICAgICAgICAgICAgICAgICAgIHNpZyA9IHRoaXMubW9kZWwuZ2V0KCJkYXRhUHJvcGVydGllcyIpLnByb3BlcnRpZXMuc2VhcmNoUmVzdWx0c1NpZ25hdHVyZS5zcGxpdCgnLCcpLA0KICAgICAgICAgICAgICAgICAgICBoYXNoID0gcXVlcnlNb2RlbC5wYXJzZUhhc2hQYXJhbWV0ZXJzKHdpbmRvdy5sb2NhdGlvbi5oYXNoKSwNCiAgICAgICAgICAgICAgICAgICAgbmV3U2VsZWN0ZWRWYWx1ZSwNCiAgICAgICAgICAgICAgICAgICAgcGFyYW0sDQogICAgICAgICAgICAgICAgICAgIGhhc2hPYmosDQogICAgICAgICAgICAgICAgICAgIGk7DQoNCiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGRhdGEub2Zmc2V0ID09PSAndW5kZWZpbmVkJykgew0KICAgICAgICAgICAgICAgICAgICBkYXRhLm9mZnNldCA9IDA7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHNpZy5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgICAgICAgICBpZiAoZW5jb2RlVVJJQ29tcG9uZW50KHNpZ1tpXSkgPT09IGRhdGEuc2VhcmNoUmVzdWx0c1NpZ25hdHVyZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEucGFnZVNpemUgPiBkYXRhLmRhdGFDb3VudCB8fCBkYXRhLm9mZnNldCA+IGRhdGEuZGF0YUNvdW50KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9XaGVuIHdlIGhhdmUgbGVzcyByZXN1bHRzIHRoZW4gcGFnZSBzaXplIHRoZW4gc2hvdyBmaXJzdCBwYWdlDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVNb2RlbEFmdGVyU2VhcmNoKGRhdGEsIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vV2FpdCB0aWxsIGFsbCByZXF1ZXN0cyBhcmUgZG9uZSBhbmQgZ28gdG8gZmlyc3QgcGFnZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3F1ZXJ5TW9kZWwudXBkYXRlSGFzaCh7ZTogMH0pOyAvLy0gdGhpcyB3aWxsIHdvcmssIGJ1dCBkb2Vzbid0IGdpdmUgdXMgcHJvcGVyIGJyb3dzZXIgaGlzdG9yeQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNoT2JqID0gcXVlcnlNb2RlbC5wYXJzZUhhc2hQYXJhbWV0ZXJzKHdpbmRvdy5sb2NhdGlvbi5oYXNoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW0gPSBkYXRhLnNlYXJjaFJlc3VsdHNTaWduYXR1cmUgIT09ICIiID8gZGF0YS5zZWFyY2hSZXN1bHRzU2lnbmF0dXJlICsgIl9lIiA6ICJlIjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhhc2hbcGFyYW1dICE9PSAiMCIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc2hPYmpbcGFyYW1dID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEJhY2tib25lLmhpc3RvcnkubmF2aWdhdGUodGhhdC5jcmVhdGVGaXJzdFBhZ2VVcmxIYXNoKGhhc2hPYmopLCB7IHRyaWdnZXI6IHRydWUsIHJlcGxhY2U6IHRydWUgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCAxMDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdTZWxlY3RlZFZhbHVlID0gTWF0aC5jZWlsKGRhdGEub2Zmc2V0IC8gZGF0YS5wYWdlU2l6ZSkgKyAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlTW9kZWxBZnRlclNlYXJjaChkYXRhLCBuZXdTZWxlY3RlZFZhbHVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAvKioNCiAgICAgICAgICAgICogQ2FsY3VsYXRlcyBoYXNoIHBhcmFtZXRlcnMgZm9yIGZpcnN0IHBhZ2UNCiAgICAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IGRhdGEgRGF0YSB0aGF0IGNvbnRhaW5zIGNvbXBvbmVudCBwcm9wZXJ0aWVzDQogICAgICAgICAgICAqIEBtZW1iZXJPZiBtb2R1bGU6c2VhcmNoUGFnZVNlbGVjdG9yLlNlYXJjaFBhZ2VTZWxlY3RvclZpZXcNCiAgICAgICAgICAgICogQGFsaWFzIG1vZHVsZTpzZWFyY2hQYWdlU2VsZWN0b3IuU2VhcmNoUGFnZVNlbGVjdG9yVmlldyNjcmVhdGVGaXJzdFBhZ2VVcmxIYXNoDQogICAgICAgICAgICAqIEByZXR1cm5zIHtTdHJpbmd9IGhhc2ggcGFyYW1ldGVyIGZvciBmaXJzdCBwYWdlDQogICAgICAgICAgICAqLw0KICAgICAgICAgICAgY3JlYXRlRmlyc3RQYWdlVXJsSGFzaDogZnVuY3Rpb24gKGhhc2hPYmopIHsNCiAgICAgICAgICAgICAgICB2YXIgaGFzaFN0ciA9ICIiOw0KDQogICAgICAgICAgICAgICAgdmFyIGkgPSAwOw0KICAgICAgICAgICAgICAgIF8uZWFjaChoYXNoT2JqLCBmdW5jdGlvbiAoaXRlbSwga2V5KSB7DQogICAgICAgICAgICAgICAgICAgIGlmIChpID4gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaGFzaFN0ciArPSAiJiI7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaSsrOw0KICAgICAgICAgICAgICAgICAgICBoYXNoU3RyICs9IGtleSArICI9IiArIGl0ZW07DQogICAgICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgICAgICByZXR1cm4gaGFzaFN0cjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQoNCiAgICAvKioNCiAgICAqIEZvciBlYWNoIHBhZ2Ugc2VsZWN0b3Igb24gYSBwYWdlIGNyZWF0ZXMgaW5zdGFuY2Ugb2YgDQogICAgKiBbIlNlYXJjaFBhZ2VTZWxlY3Rvck1vZGVsIl17QGxpbmsgbW9kdWxlOnNlYXJjaFBhZ2VTZWxlY3Rvci5TZWFyY2hQYWdlU2VsZWN0b3JNb2RlbH0gYW5kIA0KICAgICogWyJTZWFyY2hQYWdlU2VsZWN0b3JWaWV3Il17QGxpbmsgbW9kdWxlOnNlYXJjaFBhZ2VTZWxlY3Rvci5TZWFyY2hQYWdlU2VsZWN0b3JWaWV3fSANCiAgICAqIEBtZW1iZXJPZiBtb2R1bGU6c2VhcmNoUGFnZVNlbGVjdG9yDQogICAgKiBAYWxpYXMgbW9kdWxlOnNlYXJjaFBhZ2VTZWxlY3Rvci5TZWFyY2hQYWdlU2VsZWN0b3JWaWV3LmluaXQNCiAgICAqLw0KICAgIGFwaS5pbml0ID0gZnVuY3Rpb24gKCkgew0KICAgICAgICBpZiAoJCgiYm9keSIpLmhhc0NsYXNzKCJvbi1wYWdlLWVkaXRvciIpKSB7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCg0KICAgICAgICBxdWVyeU1vZGVsID0gWEEuY29tcG9uZW50LnNlYXJjaC5xdWVyeTsNCg0KICAgICAgICB2YXIgc2VhcmNoUGFnZVNlbGVjdG9yID0gJCgiLnBhZ2Utc2VsZWN0b3I6bm90KC5pbml0aWFsaXplZCkiKTsNCg0KICAgICAgICBfLmVhY2goc2VhcmNoUGFnZVNlbGVjdG9yLCBmdW5jdGlvbiAoZWxlbSkgew0KICAgICAgICAgICAgdmFyICRlbCA9ICQoZWxlbSk7DQoNCiAgICAgICAgICAgIG5ldyBTZWFyY2hQYWdlU2VsZWN0b3JWaWV3KHsgZWw6ICRlbCwgbW9kZWw6IG5ldyBTZWFyY2hQYWdlU2VsZWN0b3JNb2RlbCB9KTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgJGVsLmFkZENsYXNzKCJpbml0aWFsaXplZCIpOw0KICAgICAgICB9KTsNCiAgICB9Ow0KDQogICAgcmV0dXJuIGFwaTsNCg0KfShqUXVlcnksIGRvY3VtZW50KSk7DQoNClhBLnJlZ2lzdGVyKCdzZWFyY2hQYWdlU2VsZWN0b3InLCBYQS5jb21wb25lbnQuc2VhcmNoLnBhZ2VTZWxlY3Rvcik7DQo=
- ID: "6954b7c7-2487-423f-8600-436cb3b6dc0e"
  Hint: Size
  Value: 18659
- ID: "6f47a0a5-9c94-4b48-abeb-42d38def6054"
  Hint: Mime Type
  Value: "application/x-javascript"
- ID: "ba3f86a2-4a1c-4d78-b63d-91c2779c1b5e"
  Hint: __Sortorder
  Value: 1200
- ID: "c06867fe-9a43-4c7d-b739-48780492d06f"
  Hint: Extension
  Value: js
Languages:
- Language: en
  Versions:
  - Version: 1
    Fields:
    - ID: "25bed78c-4957-4165-998a-ca1b52f67497"
      Hint: __Created
      Value: 20160728T134137Z
    - ID: "5dd74568-4d4b-44c1-b513-0af5f4cda34f"
      Hint: __Created by
      Value: |
        sitecore\admin
