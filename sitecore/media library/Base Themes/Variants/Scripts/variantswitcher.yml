---
ID: "fbbe5143-27e9-41e2-953a-3b2774715414"
Parent: "0ce66648-1912-4e35-b478-706615a5dde5"
Template: "962b53c4-f93b-4df9-9821-415c867b8903"
Path: /sitecore/media library/Base Themes/Variants/Scripts/variantswitcher
DB: master
SharedFields:
- ID: "06d5295c-ed2f-4a54-9bf2-26228d113318"
  Hint: __Icon
  Value: "-/media/FBBE514327E941E2953A3B2774715414.ashx?h=16&thn=1&w=16"
- ID: "40e50ed9-ba07-4702-992e-a912738d32dc"
  Hint: Blob
  Value: aWYgKHR5cGVvZiAoJHhhKSAhPT0gInVuZGVmaW5lZCIpIHsNCiAgICAkeGEudmFyaWFudHN3aXRjaGVyID0gKGZ1bmN0aW9uICgkKSB7DQogICAgICAgIHZhciBwdWIgPSB7fTsNCiAgICAgICAgDQogICAgICAgIHZhciBidWlsZFZhcmlhbnRIdG1sID0gZnVuY3Rpb24gKHZhcmlhbnQsIGN1cnJlbnRWYXJpYW50KSB7DQogICAgICAgICAgICB2YXIgaW1nLCBkaXYsIHZhcmlhbnRJdGVtOw0KDQogICAgICAgICAgICBpZiAodmFyaWFudC5UaHVtYm5haWwgIT09ICIiKSB7DQogICAgICAgICAgICAgICAgdmFyaWFudEl0ZW0gPSAkKCI8bGkgZGF0YS1pZD0nIiArIHZhcmlhbnQuSUQgKyAiJyBjbGFzcz0ndmFyaWFudC1jb250YWluZXInPjwvbGk+Iik7DQogICAgICAgICAgICAgICAgaW1nV3JhcHBlciA9ICQoIjxkaXYgY2xhc3M9J2ltYWdlLXdyYXBwZXInPjxpbWcgZGF0YS1pZD0nIiArIHZhcmlhbnQuSUQgKyAiJyBjbGFzcz0ndmFyaWFudC10aHVtYm5haWwnIC8+PC9kaXY+Iik7DQogICAgICAgICAgICAgICAgaW1nV3JhcHBlci5maW5kKCJpbWciKS5hdHRyKCJzcmMiLCB2YXJpYW50LlRodW1ibmFpbCk7DQogICAgICAgICAgICAgICAgZGl2ID0gJCgiPGRpdiBkYXRhLWlkPSciICsgdmFyaWFudC5JRCArICInIGNsYXNzPSd2YXJpYW50LW5hbWUnPiIgKyB2YXJpYW50LkRpc3BsYXlOYW1lICsgIjwvZGl2PiIpOw0KICAgICAgICAgICAgICAgIHZhcmlhbnRJdGVtLmFwcGVuZChpbWdXcmFwcGVyKTsNCiAgICAgICAgICAgICAgICB2YXJpYW50SXRlbS5hcHBlbmQoZGl2KTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgdmFyaWFudEl0ZW0gPSAkKCI8bGkgZGF0YS1pZD0nIiArIHZhcmlhbnQuSUQgKyAiJz4iICsgdmFyaWFudC5EaXNwbGF5TmFtZSArICI8L2xpPiIpOyAgICAgICAgICAgICAgICANCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYgKHZhcmlhbnQuSUQgPT0gY3VycmVudFZhcmlhbnQpIHsNCiAgICAgICAgICAgICAgICB2YXJpYW50SXRlbS5hZGRDbGFzcygic2VsZWN0ZWQiKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuIHZhcmlhbnRJdGVtOw0KICAgICAgICB9DQoNCiAgICAgICAgdmFyIGlzVGh1bWJuYWlsRXhpc3QgPSBmdW5jdGlvbih2YXJpYW50cykgew0KICAgICAgICAgICAgcmV0dXJuIHZhcmlhbnRzLnNvbWUoZnVuY3Rpb24oZWxlbSkgew0KICAgICAgICAgICAgICAgIHJldHVybiBlbGVtLlRodW1ibmFpbC5sZW5ndGggPiAwOw0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0NCg0KICAgICAgICB2YXIgZml4UmVuZGVyVmFyaWFudHNMaXN0SGVpZ2h0ID0gZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgdmFyIHN3aXRjaGVyVG9vbGJhciA9ICQoJy56Zy12YXJpYW50LXN3aXRjaGVyLXRvb2xiYXInKSwNCiAgICAgICAgICAgICAgICBwb3NpdGlvbk1hbmFnZXIgPSBTaXRlY29yZS5QYWdlTW9kZXMuUG9zaXRpb25pbmdNYW5hZ2VyKCksDQogICAgICAgICAgICAgICAgc3dpdGNoZXIsDQogICAgICAgICAgICAgICAgY2hyb21lT2Zmc2V0Qm90dG9tOw0KDQogICAgICAgICAgICBpZiAoc3dpdGNoZXJUb29sYmFyLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgc3dpdGNoZXIgPSBzd2l0Y2hlclRvb2xiYXIuZmluZCgiLnpnLXZhcmlhbnQtc3dpdGNoZXIiKTsNCiAgICAgICAgICAgIGNocm9tZU9mZnNldEJvdHRvbSA9IHBvc2l0aW9uTWFuYWdlci52aWV3cG9ydFJlZ2lvbi5ib3R0b20gLSAoc3dpdGNoZXJUb29sYmFyLm9mZnNldCgpLnRvcCArIHN3aXRjaGVyVG9vbGJhci5oZWlnaHQoKSkgLSAzMDsNCiAgICAgICAgICAgIGNocm9tZU9mZnNldEJvdHRvbSA9IGNocm9tZU9mZnNldEJvdHRvbSA8IDIwID8gMjAgOiBjaHJvbWVPZmZzZXRCb3R0b207DQogICAgICAgICAgICBzd2l0Y2hlci5maW5kKCcuemctdmFyaWFudC1saXN0IC56Zy12YXJpYW50LWF2YWlsYWJsZT51bCcpLmNzcyh7ICdvdmVyZmxvdy15JzogJ2F1dG8nLCAnbWF4LWhlaWdodCc6IE1hdGguZmxvb3IoY2hyb21lT2Zmc2V0Qm90dG9tKSB9KTsNCiAgICAgICAgfQ0KDQogICAgICAgIHZhciB2YXJpYW50U3dpdGNoZXJQbHVnSW4gPSBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB2YXIgb25TZWxlY3Rpb25VcGRhdGUsDQogICAgICAgICAgICAgICAgc3dpdGNoZXJDbGFzcyA9ICJ6Zy12YXJpYW50LXN3aXRjaGVyIiwNCiAgICAgICAgICAgICAgICBzd2l0Y2hlclRvb2xiYXJDbGFzcyA9ICJ6Zy12YXJpYW50LXN3aXRjaGVyLXRvb2xiYXIiLA0KICAgICAgICAgICAgICAgIGV4cGFuZCwNCiAgICAgICAgICAgICAgICBmcmFtZSwNCiAgICAgICAgICAgICAgICBjb250cm9sc0RpdjsNCg0KICAgICAgICAgICAgb25TZWxlY3Rpb25VcGRhdGUgPSBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgdmFyIHNlbGVjdGVkID0gU2l0ZWNvcmUuUGFnZU1vZGVzLkNocm9tZU1hbmFnZXIuc2VsZWN0ZWRDaHJvbWUoKSwNCiAgICAgICAgICAgICAgICAgICAgc3dpdGNoZXJCb3ggPSAkKCI8ZGl2PiINCiAgICAgICAgICAgICAgICAgICAgICAgICsgIjxkaXYgY2xhc3M9J3pnLXZhcmlhbnQtaGVhZGVyJz5WYXJpYW50OjwvZGl2PiINCiAgICAgICAgICAgICAgICAgICAgICAgICsgIjxkaXYgY2xhc3M9J3pnLXZhcmlhbnQtbGlzdCc+Ig0KICAgICAgICAgICAgICAgICAgICAgICAgKyAiPGRpdiBjbGFzcz0nemctdmFyaWFudC1hdmFpbGFibGUnPjxzcGFuIGNsYXNzPSd6Zy12YXJpYW50LXRpcCc+U2VsZWN0IGNvbXBvbmVudCB2YXJpYW50PC9zcGFuPjwvZGl2PiINCiAgICAgICAgICAgICAgICAgICAgICAgICsgIjxkaXYgY2xhc3M9J3pnLXZhcmlhbnQtdG9nZ2xlLWRyb3Bkb3duJz48L2Rpdj4iDQogICAgICAgICAgICAgICAgICAgICAgICArICI8L2Rpdj4iDQogICAgICAgICAgICAgICAgICAgICAgICArICI8L2Rpdj4iKS5hZGRDbGFzcyhzd2l0Y2hlckNsYXNzKTsNCiAgICAgICAgICAgICAgICBzd2l0Y2hlckJveC5jc3MoImRpc3BsYXkiLCAibm9uZSIpOw0KDQogICAgICAgICAgICAgICAgJCgiLiIgKyBzd2l0Y2hlckNsYXNzKS5yZW1vdmUoKTsNCg0KICAgICAgICAgICAgICAgIGlmIChzZWxlY3RlZCA9PSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBmcmFtZSA9IFNpdGVjb3JlLlBhZ2VNb2Rlcy5DaHJvbWVNYW5hZ2VyLnNlbGVjdGlvbkZyYW1lKCk7DQogICAgICAgICAgICAgICAgY29udHJvbHNEaXYgPSAkKGZyYW1lLmNvbnRyb2xzLmNvbW1hbmRzWzBdKTsNCiAgICAgICAgICAgICAgICB0b29sYmFyID0gY29udHJvbHNEaXYucGFyZW50KCk7DQogICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkLmtleSgpICE9ICJyZW5kZXJpbmciKSB7DQogICAgICAgICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0b29sYmFyLnJlbW92ZUNsYXNzKCJ1aS1zdGF0ZS1kaXNhYmxlZCIpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGNhdGNoIChlcnJvcikgew0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjb250cm9sc0Rpdi5maW5kKCIuIiArIHN3aXRjaGVyQ2xhc3MpLmxlbmd0aCA9PSAwKSB7CS8vdHVybnMgb24gYW55IHRvb2xiYXIgd2hpY2ggaXMgbm90IHBsYWNlaG9sZGVyDQogICAgICAgICAgICAgICAgICAgIGNvbnRyb2xzRGl2LmFwcGVuZChzd2l0Y2hlckJveCk7DQogICAgICAgICAgICAgICAgICAgIHZhciByZW5kZXJpbmdEYXRhID0gSlNPTi5wYXJzZShzZWxlY3RlZC5fb3BlbmluZ01hcmtlclswXS5pbm5lckhUTUwpLA0KICAgICAgICAgICAgICAgICAgICAgICAgcGFnZUlkID0gU2l0ZWNvcmUuUGFnZU1vZGVzLlBhZ2VFZGl0b3IuaXRlbUlkKCksDQogICAgICAgICAgICAgICAgICAgICAgICByZW5kZXJpbmdJZCA9IHJlbmRlcmluZ0RhdGEuY3VzdG9tLnJlbmRlcmluZ0lELA0KICAgICAgICAgICAgICAgICAgICAgICAgZ3VpZFBhdHRlcm4gPSBuZXcgUmVnRXhwKCdeWzAtOWEtZkEtRl17MzJ9JCcsICdpJyksDQogICAgICAgICAgICAgICAgICAgICAgICBjdXN0b21wYWdlSWQgPSByZW5kZXJpbmdEYXRhLmN1c3RvbS5wYWdlSWQ7DQoNCiAgICAgICAgICAgICAgICAgICAgaWYgKGN1c3RvbXBhZ2VJZCAhPSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGN1c3RvbXBhZ2VJZCA9IGN1c3RvbXBhZ2VJZC5yZXBsYWNlKCJ7IiwgIiIpLnJlcGxhY2UoIn0iLCAiIikucmVwbGFjZSgvLS9naSwgIiIpOw0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgaWYgKGN1c3RvbXBhZ2VJZCAmJiBndWlkUGF0dGVybi50ZXN0KGN1c3RvbXBhZ2VJZCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2VJZCA9IGN1c3RvbXBhZ2VJZDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgICAgICAkLmdldCgiL3N4YS9zd2l0Y2hlci9hdmFpbGFibGUvIiArIHBhZ2VJZCArICIvIiArIHJlbmRlcmluZ0lkKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5kb25lKGZ1bmN0aW9uIChkYXRhKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YXJpYW50cyA9ICQoIjx1bD48L3VsPiIpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVuZGVyaW5nID0gU2l0ZWNvcmUuTGF5b3V0RGVmaW5pdGlvbi5nZXRSZW5kZXJpbmcoc2VsZWN0ZWQudHlwZS51bmlxdWVJZCgpKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhbnRJdGVtLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRWYXJpYW50Ow0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGlzVGh1bWJuYWlsRXhpc3QoZGF0YSkpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyaWFudHMuYWRkQ2xhc3MoImZsZXgtdGh1bWIiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgDQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFZhcmlhbnQgPSByZW5kZXJpbmdbIkBwYXIiXSA/IHJlbmRlcmluZ1siQHBhciJdLm1hdGNoKC8oRmllbGROYW1lcz0pKHsuKj99fCU3Qi4qPyU3RCkvKSA6ICIiOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudFZhcmlhbnQgIT0gbnVsbCAmJiBjdXJyZW50VmFyaWFudC5sZW5ndGggPT09IDMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRWYXJpYW50ID0gY3VycmVudFZhcmlhbnRbMl07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudFZhcmlhbnQuaW5kZXhPZigiJTdCIikgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50VmFyaWFudCA9IGRlY29kZVVSSUNvbXBvbmVudChjdXJyZW50VmFyaWFudCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50VmFyaWFudCA9ICIiOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXJpYW50SXRlbSA9IGJ1aWxkVmFyaWFudEh0bWwoZGF0YVtpXSwgY3VycmVudFZhcmlhbnQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyaWFudHMuYXBwZW5kKHZhcmlhbnRJdGVtKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhbnRJdGVtLm9uKCJjbGljayIsIGZ1bmN0aW9uIChhcmdzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNsaWNrZWRWYXJpYW50ID0gJChhcmdzLnRhcmdldCkuZGF0YSgiaWQiKSA9PSBudWxsID8gJChhcmdzLnRhcmdldC5wYXJlbnROb2RlKSA6ICQoYXJncy50YXJnZXQpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXJpYW50SWQgPSBjbGlja2VkVmFyaWFudC5kYXRhKCJpZCIpLC8vLnJlcGxhY2UoInsiLCIiKS5yZXBsYWNlKCJ9IiwiIiksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRldmljZUlkID0gU2l0ZWNvcmUuTGF5b3V0RGVmaW5pdGlvbi5nZXREZXZpY2VJRCgpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXRlY29yZUNocm9tZSA9IFNpdGVjb3JlLlBhZ2VNb2Rlcy5DaHJvbWVNYW5hZ2VyLnNlbGVjdGVkQ2hyb21lKCksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbmRlcmluZ1VpZCA9IHNpdGVjb3JlQ2hyb21lLnR5cGUudW5pcXVlSWQoKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjbGlja2VkVmFyaWFudC5wYXJlbnRzKCIuZXhwYW5kZWQiKS5sZW5ndGggPj0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTaXRlY29yZS5QYWdlTW9kZXMuUGFnZUVkaXRvci5wb3N0UmVxdWVzdCgnd2ViZWRpdDpzd2l0Y2h2YXJpYW50KHZhcmlhbnQ9JyArIHZhcmlhbnRJZCArICcsZGV2aWNlSWQ9JyArIGRldmljZUlkICsgJyxyZW5kZXJpbmdVaWQ9JyArIHJlbmRlcmluZ1VpZCArICcpJywgbnVsbCwgZmFsc2UpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCIuIiArIHN3aXRjaGVyQ2xhc3MpLnJlbW92ZUNsYXNzKCJleHBhbmRlZCIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoIi4iICsgc3dpdGNoZXJDbGFzcykudG9nZ2xlQ2xhc3MoImV4cGFuZGVkIik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5sZW5ndGggIT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaGVyQm94LmZpbmQoIi56Zy12YXJpYW50LWF2YWlsYWJsZSIpLmFwcGVuZCh2YXJpYW50cyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2hlckJveC5maW5kKCIuemctdmFyaWFudC10b2dnbGUtZHJvcGRvd24sLnpnLXZhcmlhbnQtdGlwIikub24oImNsaWNrIiwgZnVuY3Rpb24gKGFyZ3MpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXhSZW5kZXJWYXJpYW50c0xpc3RIZWlnaHQoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCIuIiArIHN3aXRjaGVyQ2xhc3MpLnRvZ2dsZUNsYXNzKCJleHBhbmRlZCIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2hlckJveC5zaG93KDMwMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3dpdGNoZXJIID0gc3dpdGNoZXJCb3gub3V0ZXJIZWlnaHQoKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyaWFudExpc3QsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhbnRMaXN0SGVpZ2h0LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXJpYW50c051bSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hyb21lT2Zmc2V0Qm90dG9tOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN3aXRjaGVySCAhPT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b29sYmFyLmFkZENsYXNzKHN3aXRjaGVyVG9vbGJhckNsYXNzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoZXJIICs9IDQ7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjaHJvbWUgPSBTaXRlY29yZS5QYWdlTW9kZXMuQ2hyb21lTWFuYWdlci5zZWxlY3RlZENocm9tZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2hyb21lPT1udWxsKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBvc2l0aW9uTWFuYWdlciA9IFNpdGVjb3JlLlBhZ2VNb2Rlcy5Qb3NpdGlvbmluZ01hbmFnZXIoKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGggPSB0b29sYmFyLmhlaWdodCgpICsgc3dpdGNoZXJILA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGltID0gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiB0b29sYmFyLndpZHRoKCksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiBoDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3UG9zaXRpb24gPSBwb3NpdGlvbk1hbmFnZXIuZ2V0Rml4ZWRDaHJvbWVSZWxhdGl2ZUVsZW1lbnRQb3NpdGlvbihkaW0sIGNocm9tZSk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU2l0ZWNvcmUuUGFnZU1vZGVzLkNocm9tZU1hbmFnZXIuc2VsZWN0aW9uRnJhbWUoKS5jb250cm9scy5kaW1lbnNpb25zID0gZGltOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b29sYmFyLmFuaW1hdGUobmV3UG9zaXRpb24sICJmYXN0Iik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhbnRMaXN0ID0gdG9vbGJhci5maW5kKCcuemctdmFyaWFudC1saXN0IGxpJyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhbnRMaXN0SGVpZ2h0ID0gdmFyaWFudExpc3QuZXEoMCkuaGVpZ2h0KCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhbnRzTnVtID0gdmFyaWFudExpc3QubGVuZ3RoOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNocm9tZU9mZnNldEJvdHRvbSA9IHBvc2l0aW9uTWFuYWdlci52aWV3cG9ydFJlZ2lvbi5ib3R0b20gLSAobmV3UG9zaXRpb24udG9wICsgZGltLmhlaWdodCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoKHZhcmlhbnRzTnVtICogdmFyaWFudExpc3RIZWlnaHQpICsgKHZhcmlhbnRMaXN0SGVpZ2h0IC8gMikpID4gY2hyb21lT2Zmc2V0Qm90dG9tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b29sYmFyLmZpbmQoJy56Zy12YXJpYW50LWxpc3QgLnpnLXZhcmlhbnQtYXZhaWxhYmxlPnVsJykuY3NzKHsgJ292ZXJmbG93LXknOiAnYXV0bycsICdtYXgtaGVpZ2h0JzogTWF0aC5mbG9vcigoY2hyb21lT2Zmc2V0Qm90dG9tIC8gdmFyaWFudExpc3RIZWlnaHQpIC0gMSkgKiB2YXJpYW50TGlzdEhlaWdodCArICdweCcgfSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoIi4iICsgc3dpdGNoZXJUb29sYmFyQ2xhc3MpLnJlbW92ZUNsYXNzKHN3aXRjaGVyVG9vbGJhckNsYXNzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCAzMDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZmFpbChmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybigiW1ZhcmlhbnQgU3dpdGNoZXJdIEZhaWxlZCB0byBnZXQgYXZhaWxhYmxlIHZhcmlhbnRzIik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH07DQoNCiAgICAgICAgICAgIC8vZml4IGZvciBleHBvcnRpbmcgc2l0ZSBpbiBBdXRob3IgTW9kZQ0KICAgICAgICAgICAgaWYgKCFYQS5oYXNQYWdlTW9kZXMoKSkgcmV0dXJuOw0KDQoNCiAgICAgICAgICAgIC8vYmluZHMgdG8gc2VsZWN0aW9uIGNoYW5nZSBldmVudCwgYnV0IGl0J3Mgbm90IGZpcmVkIHdoZW4geW91IGNsaWNrICJleHBhbmQgc2VsZWN0aW9uIg0KICAgICAgICAgICAgb25TZWxlY3Rpb25VcGRhdGUudmFyaWFudFN3aXRjaGVyID0gdHJ1ZTsNCiAgICAgICAgICAgIFNpdGVjb3JlLlBhZ2VNb2Rlcy5DaHJvbWVNYW5hZ2VyLnNlbGVjdGlvbkNoYW5nZWQuX2NhbGxiYWNrcy5wdXNoKG9uU2VsZWN0aW9uVXBkYXRlKTsNCiAgICAgICAgICAgIC8vYW5kIHNvIGhlcmUncyB0aGUgZml4Og0KICAgICAgICAgICAgdmFyIF9vbGRFeHBhbmQgPSBTaXRlY29yZS5QYWdlTW9kZXMuQ2hyb21lQ29udHJvbHMucHJvdG90eXBlLnJlbmRlckV4cGFuZENvbW1hbmQ7DQogICAgICAgICAgICBvZGxFeHBhbmQgPSBfb2xkRXhwYW5kOw0KICAgICAgICAgICAgZXhwYW5kID0gZnVuY3Rpb24gKCkgewkvL2l0IHdyYXBzIFNpdGVjb3JlJ3MgbWV0aG9kDQogICAgICAgICAgICAgICAgdmFyIGNvbnRleHQgPSB0aGlzOw0KICAgICAgICAgICAgICAgIG9uU2VsZWN0aW9uVXBkYXRlKCk7DQogICAgICAgICAgICAgICAgcmV0dXJuIF9vbGRFeHBhbmQuY2FsbChjb250ZXh0KTsgLy8gYW0gSSBldmlsIDIgOkQ/DQogICAgICAgICAgICB9Ow0KICAgICAgICAgICAgU2l0ZWNvcmUuUGFnZU1vZGVzLkNocm9tZUNvbnRyb2xzLnByb3RvdHlwZS5yZW5kZXJFeHBhbmRDb21tYW5kID0gZXhwYW5kOw0KICAgICAgICB9Ow0KDQogICAgICAgIHB1Yi5pbml0ID0gZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgdmFyaWFudFN3aXRjaGVyUGx1Z0luKCk7DQogICAgICAgIH07DQoNCiAgICAgICAgcHViLnJlbW92ZSA9IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIC8vU2l0ZWNvcmUuUGFnZU1vZGVzLkNocm9tZUNvbnRyb2xzLnByb3RvdHlwZS5yZW5kZXJFeHBhbmRDb21tYW5kID0gb2xkRXhwYW5kOw0KICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjYWxsYmFja3MubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2tzW2ldLmhhc093blByb3BlcnR5KCJ2YXJpYW50U3dpdGNoZXIiKSkgew0KICAgICAgICAgICAgICAgICAgICBTaXRlY29yZS5QYWdlTW9kZXMuQ2hyb21lTWFuYWdlci5zZWxlY3Rpb25DaGFuZ2VkLl9jYWxsYmFja3Muc3BsaWNlKGksIDEpOw0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH07DQoNCiAgICAgICAgcmV0dXJuIHB1YjsNCiAgICB9KCR4YSkpOw0KICAgICR4YS52YXJpYW50c3dpdGNoZXIuaW5pdCgpOw0KfQ0K
- ID: "6954b7c7-2487-423f-8600-436cb3b6dc0e"
  Hint: Size
  Value: 12540
- ID: "6f47a0a5-9c94-4b48-abeb-42d38def6054"
  Hint: Mime Type
  Value: "application/x-javascript"
- ID: "c06867fe-9a43-4c7d-b739-48780492d06f"
  Hint: Extension
  Value: js
Languages:
- Language: en
  Versions:
  - Version: 1
    Fields:
    - ID: "25bed78c-4957-4165-998a-ca1b52f67497"
      Hint: __Created
      Value: 20160509T092538Z
